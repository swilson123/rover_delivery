import type { FOLD_SETTING, REPORT_LEVEL } from './types.mts';
import type { CResult } from '../../types.mts';
import type { SocketArtifact } from '../../utils/alert/artifact.mts';
import type { Spinner } from '@socketsecurity/registry/lib/spinner';
import type { SocketSdkSuccessResult } from '@socketsecurity/sdk';
type AlertKey = string;
type EcoMap = Map<string, ReportLeafNode | PackageMap>;
type FileMap = Map<string, ReportLeafNode | Map<AlertKey, ReportLeafNode>>;
type PackageMap = Map<string, ReportLeafNode | VersionMap>;
type VersionMap = Map<string, ReportLeafNode | FileMap>;
export type ViolationsMap = Map<string, EcoMap>;
export interface ShortScanReport {
    healthy: boolean;
}
export interface ScanReport {
    orgSlug: string;
    scanId: string;
    options: {
        fold: FOLD_SETTING;
        reportLevel: REPORT_LEVEL;
    };
    healthy: boolean;
    alerts: ViolationsMap;
}
export type ReportLeafNode = {
    type: string;
    policy: REPORT_LEVEL;
    url: string;
    manifest: string[];
};
// Note: The returned cResult will only be ok:false when the generation
//       failed. It won't reflect the healthy state.
export declare function generateReport(scan: SocketArtifact[], securityPolicy: SocketSdkSuccessResult<'getOrgSecurityPolicy'>['data'], { fold, orgSlug, reportLevel, scanId, short, spinner }: {
    fold: FOLD_SETTING;
    orgSlug: string;
    reportLevel: REPORT_LEVEL;
    scanId: string;
    short?: boolean | undefined;
    spinner?: Spinner | undefined;
}): CResult<ScanReport | {
    healthy: boolean;
}>;
export {};
//# sourceMappingURL=generate-report.d.mts.map